l = 1/5e6
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
H
y2 = c(2.850, 3.105, 5.693, 8.101, 10.387, 3, 44, 5.5, 0.8)
x2 = c(3, 6, 12, 3, 1.4, 0.9, -1, 22, 4.3)
sig2 = sd(y2)
T = length(x2)
beta1 = 0.11
beta2 = 0.23
B = rbind(beta1, beta2)
g1 = 1/(sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e5
l = 1/5e6
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
B
H
G
sig2 = sd(y2)
T = length(x2)
beta1 = 0.11
beta2 = 0.23
B = rbind(beta1, beta2)
g1 = 1/(sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e5
l = 1/5e10
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(T*sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -beta2/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
l = 1/5e4
B
y2 = c(2.850, 3.105, 5.693, 8.101, 10.387, 3, 44, 5.5, 0.8)
x2 = c(3, 6, 12, 3, 1.4, 0.9, -1, 22, 4.3)
sig2 = sd(y2)
T = length(x2)
beta1 = 0.11
beta2 = 0.23
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e5
l = 1/5e4
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
y2 = c(2.850, 3.105, 5.693, 8.101, 10.387, 3, 44, 5.5, 0.8)
x2 = c(3, 6, 12, 3, 1.4, 0.9, -1, 22, 4.3)
sig2 = sd(y2)
T = length(x2)
beta1 = 0.11
beta2 = 0.23
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e3
l = 1/5e4
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
y = c(2.850, 3.105, 5.693, 8.101, 10.387)
x = c(0, 1, 2, 3, 4)
y2, x2=y, x
y2 = y
x2 = x
sig2 = sd(y2)
T = length(x2)
beta1 = 0.11
beta2 = 0.23
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e3
l = 1/5e4
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
summary(lm(y2~x2))
B
sig2 = sd(y2)
T = length(x2)
beta1 = 3
beta2 = 1
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e3
l = 1/100
while (tol < min(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
summary(lm(y2~x2))
beta1 = 3
beta2 = 1
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e3
l = 1/100
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
summary(lm(y2~x2))
sig2 = sd(y2)
T = length(x2)
beta1 = 3
beta2 = 5
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e3
l = 1/100
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
sig2 = sd(y2)
T = length(x2)
beta1 = 3
beta2 = 5
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e3
l = 1/1e3
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
sig2 = sd(y2)
T = length(x2)
beta1 = 3
beta2 = 5
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e3
beta1 = 1
beta2 = 0.2
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e3
l = 1/1e3
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
sig2 = sd(y2)
T = length(x2)
beta1 = 1
beta2 = 0.2
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 0.05
l = 1/1e3
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
sig2 = sd(y2)
T = length(x2)
beta1 = 1
beta2 = 0.2
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 0.05
l = 1/1e4
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
summary(lm(y2~x2))
beta1 = 1
beta2 = 0.2
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 0.05
l = 1/1e7
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
beta1 = 1
beta2 = 0.2
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 0.05
l = 1/1e5
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
beta1 = 1
beta2 = 0.2
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e4
l = 0.8
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
sig2 = sd(y2)
T = length(x2)
beta1 = 1
beta2 = 0.2
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e4
l = 0.1
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
summary(lm(y2~x2))
y2 = c(2.850, 3.105, 5.693, 8.101, 10.387, 3, 44, 5.5, 0.8)
x2 = c(3, 6, 12, 3, 1.4, 0.9, -1, 22, 4.3)
sig2 = sd(y2)
T = length(x2)
beta1 = 1
beta2 = 0.2
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e4
l = 0.1
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
summary(lm(y2~x2))
sig2 = sd(y2)
T = length(x2)
beta1 = 1
beta2 = 0.2
B = rbind(beta1, beta2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
tol = 1/1e4
l = 0.1
while (tol < max(G)){
beta1 = B[1]
beta2 = B[2]
L = 1/2*log(2/pi) - 1/2*log(sig2) - 1/(2*sig2*T)*sum( (y2 - beta1 - beta2*x2)^2)
g1 = 1/(T*sig2) *sum(y2 - beta1 - beta2*x2)
h1 = -1/(sig2)
g2 = 1/(T*sig2) * sum(y2*x2 - beta1*x2 - beta2*x2^2)
h2 = -1/(T*sig2) * sum(x2^2)
G = rbind(g1, g2)
H = matrix(c(h1, 0, 0, h2), nrow = 2, ncol = 2)
B = B - l*solve(H)%*%G
cat('G:', G, 'L:', L, '\n')
}
reg2 = lm(y2~x2)
View(reg2)
